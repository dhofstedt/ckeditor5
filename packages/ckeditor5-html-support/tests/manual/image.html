<head>
	<meta http-equiv="Content-Security-Policy"
		content="script-src 'self' https://ckeditor.com 'unsafe-inline' 'unsafe-eval'">
</head>

<style>
	[contenteditable="true"] [data-validation-allow] {
		border: 1px solid blue !important;
	}

	[contenteditable="true"] [data-validation-disallow] {
		border: 1px solid red !important;
	}
</style>

<div id="editor">
	<h3>Inline Image</h3>

	<p>
		This image should have blue border style applied.
		<img class="allowed-class disallowed-class" data-validaton-allow="Allowed attribute"
			data-validation-disallow="Disallowed attribute" style="border: 1px solid blue" src="./sample.jpg">
	</p>
	<p>
		This image should not have style applied.
		<img class="allowed-class disallowed-class" data-validaton-allow="Allowed attribute"
			data-validation-disallow="Disallowed attribute" style="border: 1px solid red" src="./sample.jpg">
	</p>

	<h3>Block Image</h3>

	<figure class="image allowed-class disallowed-class" data-validaton-allow="Allowed attribute"
		data-validation-disallow="Disallowed attribute">
		<img src="./sample.jpg" class="allowed-class disallowed-class" data-validaton-allow="Allowed attribute"
			data-validation-disallow="Disallowed attribute">
		<figcaption class="allowed-class disallowed-class" data-validaton-allow="Allowed attribute"
			data-validation-disallow="Disallowed attribute">figcaption</figcaption>
	</figure>
</div>
<script>
	document.getElementById('editor').querySelectorAll('figure, table, caption, figcaption, tbody, thead, tr, th, td').forEach(node => {
		node.setAttribute('data-validation-allow', true);
		node.setAttribute('data-validation-disallow', true);
	});
</script>
